<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <style>
      /* ì½”ì¸ ê°€ê²© ìœ„ì ¯ ìŠ¤íƒ€ì¼ */
      .crypto-widget {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 8px;
        color: white;
        font-size: 0.85rem;
      }
      
      .crypto-prices {
        display: flex;
        gap: 15px;
        align-items: center;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      .crypto-item {
        display: flex;
        align-items: center;
        gap: 5px;
        min-width: fit-content;
      }
      
      .crypto-symbol {
        font-weight: bold;
        font-size: 0.9rem;
      }
      
      .crypto-price {
        font-size: 0.8rem;
      }
      
      .crypto-change {
        font-size: 0.75rem;
        font-weight: 500;
      }
      
      .crypto-change.positive {
        color: #4ade80;
      }
      
      .crypto-change.negative {
        color: #f87171;
      }
      
      .crypto-loading {
        color: #d1d5db;
      }
    </style>
  </head>
  <body>
    <!-- ì½”ì¸ ê°€ê²© ìœ„ì ¯ -->
    <div class="crypto-widget">
      <div class="container">
        <div class="crypto-prices" id="crypto-prices">
          <div class="crypto-loading">ğŸª™ ì½”ì¸ ê°€ê²© ë¡œë”© ì¤‘...</div>
        </div>
      </div>
    </div>
    
    <header class="p-3 bg-dark text-white">
      <div class="container">
        <div
          class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start"
        >
          <ul
            class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0"
          >
            <li>
              <a id="home" href="#" class="nav-link px-2 text-secondary"
                >ğŸ  í™ˆ</a
              >
            </li>
            <li>
              <a id="hashtag" href="#" class="nav-link px-2 text-secondary"
                >#ï¸âƒ£ í•´ì‹œíƒœê·¸</a
              >
            </li>
            <li>
              <a id="bookmarks" href="#" class="nav-link px-2 text-secondary"
                >ğŸ”– ë¶ë§ˆí¬</a
              >
            </li>
            <li>
              <a id="crypto-categories" href="/crypto-center" class="nav-link px-2 text-secondary"
                >ğŸ’° ì½”ì¸ì„¼í„°</a
              >
            </li>
          </ul>

          <div class="text-end">
            <span id="username" class="text-white me-2">username</span>
            <a role="button" id="login" class="btn btn-outline-light me-2"
              >Login</a
            >
            <a
              role="button"
              id="kakao-login"
              class="btn btn-outline-light me-2"
            >
              <img alt="Kakao Login" src="/images/kakaoLogin.png" />
            </a>
            <a
              role="button"
              id="naver-login"
              class="btn btn-outline-light me-2"
            >
              <img alt="Naver Login" src="/images/naverLogin.png" />
            </a>
            <a role="button" id="logout" class="btn btn-outline-light me-2"
              >Logout</a
            >
          </div>
        </div>
      </div>
    </header>
    
    <script>
      // ì½”ì¸ ê°€ê²© ì •ë³´ë¥¼ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
      async function loadCryptoPrices() {
        try {
          const response = await fetch('/api/crypto/prices/top');
          if (!response.ok) {
            throw new Error('Failed to fetch crypto prices');
          }
          
          const cryptos = await response.json();
          const cryptoPricesElement = document.getElementById('crypto-prices');
          
          if (cryptos && cryptos.length > 0) {
            // ìƒìœ„ 6ê°œ ì½”ì¸ë§Œ í‘œì‹œ
            const topCryptos = cryptos.slice(0, 6);
            
            cryptoPricesElement.innerHTML = topCryptos.map(crypto => {
              const changeClass = crypto.priceChangePercentage24h >= 0 ? 'positive' : 'negative';
              const changeSymbol = crypto.priceChangePercentage24h >= 0 ? 'â–²' : 'â–¼';
              const formattedPrice = crypto.currentPriceKrw ? 
                Number(crypto.currentPriceKrw).toLocaleString('ko-KR') + 'ì›' :
                '$' + Number(crypto.currentPrice || 0).toLocaleString('en-US', {
                  minimumFractionDigits: 2,
                  maximumFractionDigits: 2
                });
              
              return `
                <div class="crypto-item">
                  <span class="crypto-symbol">${crypto.symbol}</span>
                  <span class="crypto-price">${formattedPrice}</span>
                  <span class="crypto-change ${changeClass}">
                    ${changeSymbol} ${Math.abs(crypto.priceChangePercentage24h || 0).toFixed(2)}%
                  </span>
                </div>
              `;
            }).join('');
          } else {
            cryptoPricesElement.innerHTML = '<div class="crypto-loading">ğŸ“Š ì½”ì¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
          }
        } catch (error) {
          console.error('Error loading crypto prices:', error);
          document.getElementById('crypto-prices').innerHTML = 
            '<div class="crypto-loading">âŒ ì½”ì¸ ê°€ê²© ë¡œë”© ì‹¤íŒ¨</div>';
        }
      }
      
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì½”ì¸ ê°€ê²© ì •ë³´ ë¡œë“œ
      document.addEventListener('DOMContentLoaded', () => {
        loadCryptoPrices();
        
        // 1ë¶„ë§ˆë‹¤ ê°€ê²© ì •ë³´ ì—…ë°ì´íŠ¸
        setInterval(loadCryptoPrices, 60000);
      });
    </script>
  </body>
</html>
